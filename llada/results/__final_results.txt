original
Avg latency with prefix cache: 6686.01 ms

torch compile
Avg latency with prefix cache: 2347.77 ms

torch compile + cudagraph
Avg latency with prefix cache: 2189.51 ms

torch compile + cudagraph + layerfusion
Avg latency with prefix cache: 2049.01 ms

torch compile + cudagraph + sgl kerne l (explain)
Avg latency with prefix cache: 2105.35 ms

+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.163.01             Driver Version: 550.163.01     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  |   00000000:00:05.0 Off |                    0 |
| N/A   32C    P0             45W /  400W |       1MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+